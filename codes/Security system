#include <Keypad.h>

// Keypad setup
const byte ROWS = 4;
const byte COLS = 4;

char keys[ROWS][COLS] = {
  {'1','2','3','A'},
  {'4','5','6','B'},
  {'7','8','9','C'},
  {'*','0','#','D'}
};

byte rowPins[ROWS] = {10, 9, 8, 7}; // Connect to keypad row pins
byte colPins[COLS] = {6, 5, 4, 3}; // Connect to keypad column pins

Keypad keypad = Keypad(makeKeymap(keys), rowPins, colPins, ROWS, COLS);

// Components
const int greenLED = 12;
const int redLED = 13;
const int buzzer = 11;

// Password settings
const String correctPassword = "1234";  // Set your custom password
String inputPassword = "";

void setup() {
  Serial.begin(9600);
  pinMode(greenLED, OUTPUT);
  pinMode(redLED, OUTPUT);
  pinMode(buzzer, OUTPUT);

  Serial.println("Enter password, press '#' to submit, '*' to clear:");
}

void loop() {
  char key = keypad.getKey();

  if (key != NO_KEY) {
    if (key == '#') {
      checkPassword();
    } else if (key == '*') {
      inputPassword = "";
      Serial.println("\nInput cleared.");
    } else {
      inputPassword += key;
      Serial.print("*"); // Masked input
    }
  }
}

void checkPassword() {
  Serial.print("\nEntered: ");
  Serial.println(inputPassword);

  if (inputPassword == correctPassword) {
    Serial.println("Access Granted");
    digitalWrite(greenLED, HIGH);
    playSuccessTone();
  } else {
    Serial.println("Access Denied");
    digitalWrite(redLED, HIGH);
    playErrorTone();
  }

  delay(2000);

  // Reset everything
  digitalWrite(greenLED, LOW);
  digitalWrite(redLED, LOW);
  inputPassword = "";
  Serial.println("Enter password, press '#' to submit:");
}

void playSuccessTone() {
  tone(buzzer, 1000, 200);
  delay(250);
  tone(buzzer, 1500, 200);
  delay(250);
  noTone(buzzer);
}

void playErrorTone() {
  for (int i = 0; i < 2; i++) {
    tone(buzzer, 400, 300);
    delay(350);
  }
  noTone(buzzer);
}
